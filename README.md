# Обучение с учителем

## Описание
Интернет-магазин «В один клик» продаёт разные товары: для детей, для дома, мелкую бытовую технику, косметику и даже продукты. Отчёт магазина за прошлый период показал, что активность покупателей начала снижаться. Привлекать новых клиентов уже не так эффективно: о магазине и так знает большая часть целевой аудитории. Возможный выход — удерживать активность постоянных клиентов. Сделать это можно с помощью персонализированных предложений. Нам поручили разработать решение, которое позволит персонализировать предложения постоянным клиентам, чтобы увеличить их покупательскую активность.

**Цель:** Разработать модель, которая предскажет вероятность снижения покупательской активности. Выделить сегменты покупателей, проанализировать их и предложить, как увеличит покупательскую активность.

## Данные
- Источник: локальные CSV в каталоге `datasets/`
- Пример: `market_file.csv`, `market_money.csv`, `market_time.csv`, `money.csv`
- Дополнительно приведена `Схема признаков.png` 

## Подход / Модели
- Построены пайплайны для подготовки данных для моделирования и обучения моделей. Проведен перебор гиперпараметров для четырёх моделей - KNN, DecisionTree, LogisticRegression, SVC - с помощью GridSearchCV. 
- В качестве основной метрики выбрана recall (охват), чтобы минимизировать пропуск клиентов с реальным снижением активности.

## Результаты
- Лучшей моделью для данной задачи оказалась LogisticRegression с L1-регуляризацией: recall = 0.846 на тестовой выборке.
- Проведен анализ важности признаков: с помощью SHAP-методов определены наиболее значимые признаки для модели: `Страниц_за_визит`, `Время_предыдущий_месяц`, `Время_текущий_месяц`, `Акционные_покупки`, `Средний_просмотр_категорий_за_визит`, `Неоплаченные_продукты_штук_квартал`, `Маркет_актив_6_мес`. Категориальные и финансовые признаки оказались малозначимыми для определения снижения покупательской активности.
- По результатам моделирования и прибыльности (данные финансового департамента) проведена сегментация клиентов и составлены рекомендации для бизнеса. Выделены ключевые сегменты:
	- (1) клиенты с высокой вероятностью снижения покупательской активности и высокой прибылью,
	- (2) клиенты с высокой вероятностью снижения покупательской активности и максимальной долей покупок по акциям, 
	- (3) клиенты, в покупках которых наиболее популярна техника (товары с длительным жизненным циклом). 
- Для каждого сегмента даны рекомендации по удержанию и повышению покупательской активности: персонализация маркетинга, развитие программ лояльности, стимулирование вовлечённости и кросс-продажи.

## Структура репозитория
.
├── README.md
├── Спринт12_Проект_по_МО.ipynb
├── datasets/
│ ├── market_file.csv
│ ├── market_money.csv
│ ├── market_time.csv
│ └── money.csv
└── .gitignore

## Как воспроизвести
1. Открыть `Спринт12_Проект_по_МО.ipynb` в Jupyter/VS Code
2. Запустить ячейки по порядку

## Ссылки
- Issue с идеями улучшений: *(добавить ссылку после создания)*
- Репозиторий: *(добавит ссылку после публикации на GitHub)*
